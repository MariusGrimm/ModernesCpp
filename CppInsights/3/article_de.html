<div class="vorspann">In Andreas Fertigs heutigem Artikel geht es um die Template-Instanziierung. C++ Insights hilft, diesen automatischen Prozess besser zu verstehen.</div><div class="text">Die Zukunft von C++ spricht Templates. Daher ist es eine sehr gute Idee, dein Wissen über Templates zu vertiefen.</div><div class="ztitel">Template-Instanziierung<br></div><div class="text">Ich möchte an dieser Stelle mit einem Haftungsausschluss beginnen. Es gibt andere Werkzeuge, um diese Arbeit zu erledigen. Ich habe eine Vorschau von Visual Studio gesehen, in der wir das instanziierte Template anzeigen können. Gleiches gilt für Cevelop. Es ist keine einzigartige Funktion, die C++ Insights hier bietet. Mit Ausnahme eines Unterschieds werden hier die Transformationen für den gesamten Code angezeigt, den wir auf einmal eingeben. Alles! Nicht nur Templates.<br></div><div class="text">Worüber ich spreche, ist eine Situation, von der ich glaube, dass sie viele von uns mindestens einmal erlebt haben? Es gibt dieses Funktions-Template. Wir möchten gerne wissen, für welche Typen es instanziiert wird und woher. Eine einfache Sache für C++ Insights. Der Compiler muss dies wissen, ebenso C++ Insights.<br></div><div class="text">In der Lage zu sein, den Code zu zeigen, der effektiv läuft, ist während des Unterrichts von Wert. Ich habe erfahren, dass es den Schülern sehr geholfen hat, wenn sie sehen können, was los ist.</div><div class="ztitel_kleiner">Template-Instanziierung ist Lazy<br></div><div class="text">Eine schöne Sache, die C++ Insights zeigt, ist, was es nicht zeigt. Der Compiler, zumindest Clang, in dem C++ Insights läuft, ist bestrebt, uns den effizientesten Code zu liefern. Bei Templates generiert der Compiler Code nur für Funktionen oder Methoden, die tatsächlich verwendet werden. Wir können ein Klassen-Template mit einer bestimmten Methode haben, die niemals aufgerufen wird. Wie hier:</div><div class="pre">template&lt;typename T&gt;<br>class Apple<br>{<br>public:<br>&nbsp; Apple() = default;<br>&nbsp; <br>&nbsp; bool IsGreen() const { return false; }<br>&nbsp; bool IsRed() const { return true; }<br>};<br><br>int main()<br>{<br>&nbsp; Apple&lt;int&gt; apple;<br>&nbsp; <br>&nbsp; if( apple.IsRed()) {}<br>}</div><div class="text">In diesem Fall generiert der Compiler nicht den Methodenrumpf dieser Instantiierung (<i>Apple &lt;int&gt;</i>), wie wir in <a title="Link auf https://cppinsights.io/lnk?code=dGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKfQ==&amp;std=cpp17&amp;rev=1.0" alt="%7B%22anchor%22%3A%22%22%2C%22target%22%3A%22_blank%22%2C%22alias%22%3A%22%22%2C%22ir_link%22%3A1%2C%22text%22%3A%22C%2B%2B%20Insights%22%2C%22subject%22%3A%22%22%2C%22version%22%3A1%2C%22user_params%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22destination%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DdGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22custom%22%3A%7B%7D%2C%22href%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DdGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%7D" href="https://cppinsights.io/lnk?code=dGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKfQ==&amp;std=cpp17&amp;rev=1.0">C++ Insights</a> sehen können:<br></div><div class="pre">template&lt;typename T&gt;<br>class Apple<br>{<br>public:<br>&nbsp; Apple() = default;<br>&nbsp; <br>&nbsp; bool IsGreen() const { return false; }<br>&nbsp; bool IsRed() const { return true; }<br>};<br><br>/* First instantiated from: insights.cpp:13 */<br>#ifdef INSIGHTS_USE_TEMPLATE<br>template&lt;&gt;<br>class Apple&lt;int&gt;<br>{&nbsp; <br>&nbsp; public: <br>&nbsp; // inline constexpr Apple() noexcept = default;<br>&nbsp; inline bool IsGreen() const;<br>&nbsp; <br>&nbsp; inline bool IsRed() const;<br>&nbsp; <br>&nbsp; // inline constexpr Apple(const Apple&lt;int&gt; &amp;) = default;<br>&nbsp; // inline constexpr Apple(Apple&lt;int&gt; &amp;&amp;) = default;<br>};<br><br>#endif<br><br><br>int main()<br>{<br>&nbsp; Apple&lt;int&gt; apple = Apple&lt;int&gt;();<br>}<br></div><div class="text">Selbst wenn die Methode mit einer anderen Instanziierung (<i>Apple &lt;char&gt;</i>) verwendet wird, gibt es keinen Code für die<i> int</i>-Variante. Natürlich ist die Methode für <i>Apple &lt;char&gt;</i> vorhanden. Überzeugen wir uns selbst in <a href="https://cppinsights.io/lnk?code=dGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKICBBcHBsZTxjaGFyPiBjQXBwbGU7CiAgCiAgY0FwcGxlLklzR3JlZW4oKTsKfQ==&amp;std=cpp17&amp;rev=1.0" alt="%7B%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22ir_link%22%3A1%2C%22alias%22%3A%22%22%2C%22text%22%3A%22C%2B%2B%20Insights%22%2C%22target%22%3A%22_blank%22%2C%22anchor%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DdGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKICBBcHBsZTxjaGFyPiBjQXBwbGU7CiAgCiAgY0FwcGxlLklzR3JlZW4oKTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22destination%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DdGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKICBBcHBsZTxjaGFyPiBjQXBwbGU7CiAgCiAgY0FwcGxlLklzR3JlZW4oKTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22custom%22%3A%7B%7D%2C%22type%22%3A%22E%22%7D" title="Link auf https://cppinsights.io/lnk?code=dGVtcGxhdGU8dHlwZW5hbWUgVD4KY2xhc3MgQXBwbGUKewpwdWJsaWM6CiAgQXBwbGUoKSA9IGRlZmF1bHQ7CiAgCiAgYm9vbCBJc0dyZWVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KICBib29sIElzUmVkKCkgY29uc3QgeyByZXR1cm4gdHJ1ZTsgfQp9OwoKaW50IG1haW4oKQp7CiAgQXBwbGU8aW50PiBhcHBsZTsKICBBcHBsZTxjaGFyPiBjQXBwbGU7CiAgCiAgY0FwcGxlLklzR3JlZW4oKTsKfQ==&amp;std=cpp17&amp;rev=1.0">C++ Insights</a>:<br></div><div class="pre">template&lt;typename T&gt;<br>class Apple<br>{<br>public:<br>&nbsp; Apple() = default;<br>&nbsp; <br>&nbsp; bool IsGreen() const { return false; }<br>&nbsp; bool IsRed() const { return true; }<br>};<br><br>/* First instantiated from: insights.cpp:13 */<br>#ifdef INSIGHTS_USE_TEMPLATE<br>template&lt;&gt;<br>class Apple&lt;int&gt;<br>{&nbsp; <br>&nbsp; public: <br>&nbsp; // inline constexpr Apple() noexcept = default;<br>&nbsp; inline bool IsGreen() const;<br>&nbsp; <br>&nbsp; inline bool IsRed() const;<br>&nbsp; <br>&nbsp; // inline constexpr Apple(const Apple&lt;int&gt; &amp;) = default;<br>&nbsp; // inline constexpr Apple(Apple&lt;int&gt; &amp;&amp;) = default;<br>};<br><br>#endif<br><br><br>/* First instantiated from: insights.cpp:14 */<br>#ifdef INSIGHTS_USE_TEMPLATE<br>template&lt;&gt;<br>class Apple&lt;char&gt;<br>{&nbsp; <br>&nbsp; public: <br>&nbsp; // inline constexpr Apple() noexcept = default;<br>&nbsp; inline bool IsGreen() const<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; return false;<br>&nbsp; }<br>&nbsp; <br>&nbsp; inline bool IsRed() const;<br>&nbsp; <br>&nbsp; // inline constexpr Apple(const Apple&lt;char&gt; &amp;) = default;<br>&nbsp; // inline constexpr Apple(Apple&lt;char&gt; &amp;&amp;) = default;<br>};<br><br>#endif<br><br><br>int main()<br>{<br>&nbsp; Apple&lt;int&gt; apple = Apple&lt;int&gt;();<br>&nbsp; Apple&lt;char&gt; cApple = Apple&lt;char&gt;();<br>&nbsp; cApple.IsGreen();<br>}<br></div><div class="text">Was wir auch mit C++ Insights sehen können, ist, welche Zeile im ursprünglichen Code die Instanziierung verursacht hat. Dies kann hilfreich sein, wenn wir eine bestimmte Instantiierung nicht erwarten.</div><div class="ztitel_kleiner">Class Template Argument Deduction<br></div><div class="text">Bei der Verwendung von C++ 17 und CTAD (Class Template Argument Deduction) kann es manchmal weniger offensichtlich sein, welche Typen man erhalten hat. Nehme diesen Code an (ich weiß, dass es wahrscheinlich leicht zu sehen ist):<br></div><div class="pre">#include &lt;vector&gt;<br><br>int main()<br>{<br>&nbsp; std::vector v{1,2,3};<br>&nbsp; std::vector vd{1.0,2.0,3.0};<br><br>&nbsp; //v = vd; // does not compile<br>}<br></div><div class="text">Wir haben zwei <i>std::vector</i>, denen jeweils drei Nummern zugewiesen werden. Trotz der Tatsache, dass diese beiden Vektoren wirklich gleich aussehen, können wir <i>vd</i> nicht <i>v</i> zuweisen. Es ist wahrscheinlich offensichtlich, dass <i>v</i> vom Typ <i>int</i> ist, während <i>vd</i> vom Typ <i>double</i> ist. Eine einfache Sache für <a href="https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHZlY3Rvcj4KCmludCBtYWluKCkKewogIHN0ZDo6dmVjdG9yIHZ7MSwyLDN9OwogIHN0ZDo6dmVjdG9yIHZkezEuMCwyLjAsMy4wfTsKCiAgLy92ID0gdmQ7IC8vIGRvZXMgbm90IGNvbXBpbGUKfQ==&amp;std=cpp17&amp;rev=1.0" alt="%7B%22custom%22%3A%7B%7D%2C%22destination%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHZlY3Rvcj4KCmludCBtYWluKCkKewogIHN0ZDo6dmVjdG9yIHZ7MSwyLDN9OwogIHN0ZDo6dmVjdG9yIHZkezEuMCwyLjAsMy4wfTsKCiAgLy92ID0gdmQ7IC8vIGRvZXMgbm90IGNvbXBpbGUKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22type%22%3A%22E%22%2C%22href%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHZlY3Rvcj4KCmludCBtYWluKCkKewogIHN0ZDo6dmVjdG9yIHZ7MSwyLDN9OwogIHN0ZDo6dmVjdG9yIHZkezEuMCwyLjAsMy4wfTsKCiAgLy92ID0gdmQ7IC8vIGRvZXMgbm90IGNvbXBpbGUKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22anchor%22%3A%22%22%2C%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22alias%22%3A%22%22%2C%22text%22%3A%22C%2B%2B%20Insights%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22user_params%22%3A%22%22%7D" title="Link auf https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHZlY3Rvcj4KCmludCBtYWluKCkKewogIHN0ZDo6dmVjdG9yIHZ7MSwyLDN9OwogIHN0ZDo6dmVjdG9yIHZkezEuMCwyLjAsMy4wfTsKCiAgLy92ID0gdmQ7IC8vIGRvZXMgbm90IGNvbXBpbGUKfQ==&amp;std=cpp17&amp;rev=1.0">C++ Insights</a>:<br></div><div class="pre">#include &lt;vector&gt;<br><br>int main()<br>{<br>&nbsp; std::vector&lt;int, std::allocator&lt;int&gt; &gt; v = std::vector&lt;int, std::allocator&lt;int&gt; &gt;{std::initializer_list&lt;int&gt;{1, 2, 3}, std::allocator&lt;int&gt;()};<br>&nbsp; std::vector&lt;double, std::allocator&lt;double&gt; &gt; vd = std::vector&lt;double, std::allocator&lt;double&gt; &gt;{std::initializer_list&lt;double&gt;{1.0, 2.0, 3.0}, std::allocator&lt;double&gt;()};<br>}<br></div><div class="text">Dort kann man sehen, welchen Typ der Vektor wirklich hat.</div><div class="ztitel_kleiner">constexpr if<br></div><div class="text">Während wir über C++ 17 sprechen, gibt es eine weitere neue Funktion: <i>constexpr if</i>. Schauen wir uns an, was C++ Insights für uns dort leisten kann. Im folgenden Beispiel haben wir eine <i>stringify</i>-Vorlage, die aus dem an die Funktion übergebenen Parameter eine <i>std::string</i> <a title="Link auf https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSB7CiAgICByZXR1cm4gc3RkOjp0b19zdHJpbmcodCk7CiAgfQp9CgppbnQgbWFpbigpCnsKICBhdXRvIHggPSBzdHJpbmdpZnkoMik7CiAgYXV0byB5ID0gc3RyaW5naWZ5KHN0ZDo6c3RyaW5neyJIZWxsbyJ9KTsKfQ==&amp;std=cpp17&amp;rev=1.0" href="https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSB7CiAgICByZXR1cm4gc3RkOjp0b19zdHJpbmcodCk7CiAgfQp9CgppbnQgbWFpbigpCnsKICBhdXRvIHggPSBzdHJpbmdpZnkoMik7CiAgYXV0byB5ID0gc3RyaW5naWZ5KHN0ZDo6c3RyaW5neyJIZWxsbyJ9KTsKfQ==&amp;std=cpp17&amp;rev=1.0" alt="%7B%22destination%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ%2BCnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSB7CiAgICByZXR1cm4gc3RkOjp0b19zdHJpbmcodCk7CiAgfQp9CgppbnQgbWFpbigpCnsKICBhdXRvIHggPSBzdHJpbmdpZnkoMik7CiAgYXV0byB5ID0gc3RyaW5naWZ5KHN0ZDo6c3RyaW5neyJIZWxsbyJ9KTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22type%22%3A%22E%22%2C%22custom%22%3A%7B%7D%2C%22href%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ%2BCnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSB7CiAgICByZXR1cm4gc3RkOjp0b19zdHJpbmcodCk7CiAgfQp9CgppbnQgbWFpbigpCnsKICBhdXRvIHggPSBzdHJpbmdpZnkoMik7CiAgYXV0byB5ID0gc3RyaW5naWZ5KHN0ZDo6c3RyaW5neyJIZWxsbyJ9KTsKfQ%3D%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22target%22%3A%22_blank%22%2C%22anchor%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22text%22%3A%22erstellt%22%2C%22alias%22%3A%22%22%2C%22ir_link%22%3A1%7D">erstellt</a>:</div><div class="pre">#include &lt;string&gt;<br>#include &lt;type_traits&gt;<br><br>template &lt;typename T&gt;<br>std::string stringify(T&amp;&amp; t)<br>{<br>&nbsp; if constexpr(std::is_same_v&lt;T, std::string&gt;) {<br>&nbsp;&nbsp;&nbsp; return t;<br>&nbsp; } else {<br>&nbsp;&nbsp;&nbsp; return std::to_string(t);<br>&nbsp; }<br>}<br><br>int main()<br>{<br>&nbsp; auto x = stringify(2);<br>&nbsp; auto y = stringify(std::string{"Hello"});<br>}<br></div><div class="text">Wenn wir einen <i>std::string</i> übergeben, wird dieser String natürlich zurückgegeben. Das <i>constexpr if</i> macht dieses Funktions-Template überhaupt erst möglich. Denn es gibt keine <i>to_string</i>-Funktion, die einen <i>std::string</i> entgegennimmt. Mit einem normalen <i>if</i> würde dieser Code nicht kompilieren.</div><div class="text">Was passiert nun, wenn wir einen C-String übergeben? Wie hier:<br></div><div class="pre">#include &lt;string&gt;<br>#include &lt;type_traits&gt;<br><br>template &lt;typename T&gt;<br>std::string stringify(T&amp;&amp; t)<br>{<br>&nbsp; if constexpr(std::is_same_v&lt;T, std::string&gt;) {<br>&nbsp;&nbsp;&nbsp; return t;<br>&nbsp; } else {<br>&nbsp;&nbsp;&nbsp; return std::to_string(t);<br>&nbsp; }<br>}<br><br>int main()<br>{<br>&nbsp; auto x = stringify(2);<br>&nbsp; auto y = stringify("hello");<br>}<br></div><div class="text">Es wird nicht kompiliert. Der Grund ist, dass es auch kein <i>to_string</i> für ein <i>char</i>-Array gibt. Wir können dies beheben, indem wir für diesen Fall ein zusätzliches <i>if</i> <a title="Link auf https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSBpZiBjb25zdGV4cHIoc3RkOjppc19hcnJheV92PCBzdGQ6OnJlbW92ZV9yZWZlcmVuY2VfdDxUPiA+KSB7CiAgICByZXR1cm4gc3RkOjpzdHJpbmd7dH07CiAgfSBlbHNlIHsKICAgIHJldHVybiBzdGQ6OnRvX3N0cmluZyh0KTsKICB9Cn0KCmludCBtYWluKCkKewogIGF1dG8geCA9IHN0cmluZ2lmeSgyKTsKICBhdXRvIHkgPSBzdHJpbmdpZnkoImhlbGxvIik7Cn0=&amp;std=cpp17&amp;rev=1.0" alt="%7B%22href%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ%2BCnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSBpZiBjb25zdGV4cHIoc3RkOjppc19hcnJheV92PCBzdGQ6OnJlbW92ZV9yZWZlcmVuY2VfdDxUPiA%2BKSB7CiAgICByZXR1cm4gc3RkOjpzdHJpbmd7dH07CiAgfSBlbHNlIHsKICAgIHJldHVybiBzdGQ6OnRvX3N0cmluZyh0KTsKICB9Cn0KCmludCBtYWluKCkKewogIGF1dG8geCA9IHN0cmluZ2lmeSgyKTsKICBhdXRvIHkgPSBzdHJpbmdpZnkoImhlbGxvIik7Cn0%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22type%22%3A%22E%22%2C%22destination%22%3A%22https%3A%2F%2Fcppinsights.io%2Flnk%3Fcode%3DI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ%2BCnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSBpZiBjb25zdGV4cHIoc3RkOjppc19hcnJheV92PCBzdGQ6OnJlbW92ZV9yZWZlcmVuY2VfdDxUPiA%2BKSB7CiAgICByZXR1cm4gc3RkOjpzdHJpbmd7dH07CiAgfSBlbHNlIHsKICAgIHJldHVybiBzdGQ6OnRvX3N0cmluZyh0KTsKICB9Cn0KCmludCBtYWluKCkKewogIGF1dG8geCA9IHN0cmluZ2lmeSgyKTsKICBhdXRvIHkgPSBzdHJpbmdpZnkoImhlbGxvIik7Cn0%3D%26amp%3Bstd%3Dcpp17%26amp%3Brev%3D1.0%22%2C%22custom%22%3A%7B%7D%2C%22user_params%22%3A%22%22%2C%22subject%22%3A%22%22%2C%22version%22%3A1%2C%22text%22%3A%22angeben%22%2C%22alias%22%3A%22%22%2C%22ir_link%22%3A1%2C%22target%22%3A%22_blank%22%2C%22anchor%22%3A%22%22%7D" href="https://cppinsights.io/lnk?code=I2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHR5cGVfdHJhaXRzPgoKdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CnN0ZDo6c3RyaW5nIHN0cmluZ2lmeShUJiYgdCkKewogIGlmIGNvbnN0ZXhwcihzdGQ6OmlzX3NhbWVfdjxULCBzdGQ6OnN0cmluZz4pIHsKICAgIHJldHVybiB0OwogIH0gZWxzZSBpZiBjb25zdGV4cHIoc3RkOjppc19hcnJheV92PCBzdGQ6OnJlbW92ZV9yZWZlcmVuY2VfdDxUPiA+KSB7CiAgICByZXR1cm4gc3RkOjpzdHJpbmd7dH07CiAgfSBlbHNlIHsKICAgIHJldHVybiBzdGQ6OnRvX3N0cmluZyh0KTsKICB9Cn0KCmludCBtYWluKCkKewogIGF1dG8geCA9IHN0cmluZ2lmeSgyKTsKICBhdXRvIHkgPSBzdHJpbmdpZnkoImhlbGxvIik7Cn0=&amp;std=cpp17&amp;rev=1.0">angeben</a>:<br></div><div class="pre">#include &lt;string&gt;<br>#include &lt;type_traits&gt;<br><br>template &lt;typename T&gt;<br>std::string stringify(T&amp;&amp; t)<br>{<br>&nbsp; if constexpr(std::is_same_v&lt;T, std::string&gt;) {<br>&nbsp;&nbsp;&nbsp; return t;<br>&nbsp; } else if constexpr(std::is_array_v&lt; std::remove_reference_t&lt;T&gt; &gt;) {<br>&nbsp;&nbsp;&nbsp; return std::string{t};<br>&nbsp; } else {<br>&nbsp;&nbsp;&nbsp; return std::to_string(t);<br>&nbsp; }<br>}<br><br>int main()<br>{<br>&nbsp; auto x = stringify(2);<br>&nbsp; auto y = stringify("hello");<br>}<br></div><div class="text">Jetzt kompiliert es. Was C++ Insights uns zeigt, sind die Template-Instanziierungen für die beiden Typen. Aber es gibt noch mehr. Es zeigt auch, welcher <i>if</i>-Zweig in dieser Instanziierung verwendet wird. Wenn wir genau hinsehen, können wir noch etwas anderes erkennen. C++ Insights zeigt uns auch, dass es in C++ kein <i>else if</i> gibt. Es gibt nur ein <i>if</i> und ein <i>else</i>. Warum ist das wichtig? Weil wir <i>constexpr</i> auf alle <i>if</i>-Zweige anwenden müssen. Ansonsten erhalten wir ein Laufzeit <i>if</i> in einem <i>constexpr if else</i>-Zweig.<br></div><div class="text">Viel Spaß mit C++ Insights. Wer möchte, kann das Projekt unterstützen, entweder als <a title="Link auf https://www.patreon.com/cppinsights" alt="%7B%22href%22%3A%22https%3A%2F%2Fwww.patreon.com%2Fcppinsights%22%2C%22type%22%3A%22E%22%2C%22custom%22%3A%7B%7D%2C%22destination%22%3A%22https%3A%2F%2Fwww.patreon.com%2Fcppinsights%22%2C%22ir_link%22%3A1%2C%22alias%22%3A%22%22%2C%22text%22%3A%22Patreon%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22anchor%22%3A%22%22%2C%22target%22%3A%22_blank%22%7D" href="https://www.patreon.com/cppinsights">Patreon</a> oder natürlich auch mit <a href="https://github.com/andreasfertig/cppinsights" alt="%7B%22anchor%22%3A%22%22%2C%22target%22%3A%22_blank%22%2C%22text%22%3A%22Code-Beitr%C3%A4gen%22%2C%22ir_link%22%3A1%2C%22alias%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22subject%22%3A%22%22%2C%22version%22%3A1%2C%22custom%22%3A%7B%7D%2C%22type%22%3A%22E%22%2C%22destination%22%3A%22https%3A%2F%2Fgithub.com%2Fandreasfertig%2Fcppinsights%22%2C%22href%22%3A%22https%3A%2F%2Fgithub.com%2Fandreasfertig%2Fcppinsights%22%7D" title="Link auf https://github.com/andreasfertig/cppinsights">Code-Beiträgen</a>. Demnächst mehr zu C++ Insights zu Variadic Templates.<br></div>
